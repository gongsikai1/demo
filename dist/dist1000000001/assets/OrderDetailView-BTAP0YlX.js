import{d as z,r as c,p as Q,b as Z,o as a,c as u,t as n,a as l,B as i,f as d,w as o,g as m,i as $,e as v,F as T,h as I,l as x,k as ee,E as F,j as D}from"./index-DpYZfZlD.js";import{A as y}from"./index-BHndqmlX.js";import{h as _}from"./moment-C5S46NFB.js";const te={class:"about"},se={key:0,class:"address"},ae={key:1,class:"address"},le={key:2,class:"address"},oe={key:3,class:"address"},ue={key:4,class:"address"},ne={key:5,class:"address"},re={key:6,class:"pay_status"},de={key:7,class:"pay_status"},ie={key:8,class:"shop_name"},ve={key:9,class:"shop_name"},_e={key:10},me={key:11},pe={key:12,class:"pay_status"},ce={key:13,class:"pay_status"},ge={key:14,class:"pay_status"},ye={key:15,class:"pay_status"},ke={key:16,class:"pay_status"},fe={key:17,class:"pay_status"},$e={key:18,class:"deliver_status"},De={key:19,class:"deliver_status"},he={key:20},Ce={key:21},Ee={key:22},Pe={key:23},Se={key:24,class:"deliver_status"},Re={key:25,class:"deliver_status"},Ae={key:26},Ye={key:27},be={class:"cart-item"},Ve=z({__name:"OrderDetailView",setup(Te){const N=x(),C=ee();c({}),c(1);const J=c([]);c(null);const s=c({}),g=c({}),E=c([]),P=c({}),R=c("0"),A=c({}),Y=c({}),K=()=>{y.CART.LIST().then(e=>{console.log("res",e),J.value=e})},O=()=>{const e=g.value.uuid;console.log("addressDetail",g),y.ORDER.PAY({address_uuid:e,order_uuid:C.params.uuid}).then(t=>{console.log("res",t.pay_uuid),N.push(`/pay/${t.pay_uuid}`),document.body.style.cursor="default"})},b=()=>{y.ORDER.DETAIL({uuid:C.params.uuid}).then(e=>{console.log("res getOrderDetail",e),s.value=e,G({address_uuid:e.address_uuid}),e.shop_uuid&&q({shop_uuid:e.shop_uuid}),e.deliver_uuid&&W({deliver_uuid:e.deliver_uuid})})},j=({deliver_no:e})=>{console.log("getDeliverDetailExpress"),y.DELIVER.DETAIL_EXPRESS({deliver_no:e}).then(t=>{console.log("res",t),P.value=t})},G=({address_uuid:e})=>{y.ADDRESS.DETAIL({uuid:e}).then(t=>{console.log("res API.ADDRESS.DETAIL",t),g.value=t,console.log("addressDetail.value",g.value)})},W=({deliver_uuid:e})=>{y.DELIVER.LIST({uuid:e}).then(t=>{console.log("res",t),j({deliver_no:t[0].deliver_no}),E.value=t})},S=Q(()=>{try{const e=decodeURIComponent(s.value.order_json||'""');return JSON.parse(e)}catch(e){return console.error("Error parsing order JSON:",e),[]}}),V=()=>{console.log("orderDetail",s),y.PAY.BACK({uuid:s.value.pay_uuid,order_uuid:C.params.uuid}).then(e=>{console.log("res",e),F.success("退款成功"),b()})},X=()=>{y.PAY.BACK_CHECK({order_uuid:C.params.uuid}).then(e=>{A.value=e,console.log("res",e)})},q=({shop_uuid:e})=>{y.USER.NAME({uuid:e}).then(t=>{console.log("res",t),Y.value=t})},L=()=>{N.push(`/chat/${s.value.shop_uuid}`)},B=()=>{y.POINT.ADD({order_uuid:C.params.uuid}).then(e=>{console.log("res",e),F.success("获取积分成功"),b()})};return Z(()=>{K(),b(),X()}),(e,t)=>{const k=D("el-button"),M=D("el-timeline-item"),H=D("el-timeline"),U=D("el-collapse-item"),w=D("el-collapse"),p=D("el-col"),f=D("el-row");return a(),u("div",te,[e.$store.state.lang==="cn"?(a(),u("div",se," 下单地址："+n(g.value.full_address),1)):l("",!0),e.$store.state.lang==="en"?(a(),u("div",ae," Ordering Address: "+n(g.value.full_address),1)):l("",!0),e.$store.state.lang==="cn"?(a(),u("div",le," 下单人："+n(g.value.name),1)):l("",!0),e.$store.state.lang==="en"?(a(),u("div",oe," Order Placer: "+n(g.value.name),1)):l("",!0),e.$store.state.lang==="cn"?(a(),u("div",ue," 下单号码："+n(g.value.phone),1)):l("",!0),e.$store.state.lang==="en"?(a(),u("div",ne," Order Number: "+n(g.value.phone),1)):l("",!0),e.$store.state.lang==="cn"?(a(),u("div",re," 下单时间："+n(i(_)(s.value.create_time).format("YYYY年MM月DD日 HH时mm分ss秒")),1)):l("",!0),e.$store.state.lang==="en"?(a(),u("div",de," Order Time: "+n(i(_)(s.value.create_time).format("MM/DD/YYYY HH:mm:ss")),1)):l("",!0),e.$store.state.lang==="cn"?(a(),u("div",ie," 下单店铺："+n(decodeURIComponent(Y.value.name)),1)):l("",!0),e.$store.state.lang==="en"?(a(),u("div",ve," Store Where The Order Is Placed: "+n(decodeURIComponent(Y.value.name)),1)):l("",!0),s.value.is_backing&&e.$store.state.lang==="cn"?(a(),u("div",_e," 支付状态："+n("已退款"))):l("",!0),s.value.is_backing&&e.$store.state.lang==="en"?(a(),u("div",me," Payment Status: "+n("Refunded"))):s.value.status===0&&i(_)().diff(i(_)(s.value.create_time),"minutes")>60&&e.$store.state.lang==="cn"?(a(),u("div",pe," 支付状态："+n(s.value.status===0&&i(_)().diff(i(_)(s.value.create_time),"minutes")>60?"已关闭":""),1)):s.value.status===0&&i(_)().diff(i(_)(s.value.create_time),"minutes")>60&&e.$store.state.lang==="en"?(a(),u("div",ce," Payment Status: "+n(s.value.status===0&&i(_)().diff(i(_)(s.value.create_time),"minutes")>60?"Closed":""),1)):e.$store.state.lang==="cn"?(a(),u("div",ge," 支付状态："+n(s.value.status===0?"未支付":"已支付"),1)):e.$store.state.lang==="en"?(a(),u("div",ye," Payment Status: "+n(s.value.status===0?"Unpaid":"Paid"),1)):l("",!0),s.value.status===1&&e.$store.state.lang==="cn"?(a(),u("div",ke," 支付时间："+n(i(_)(s.value.pay_time).format("YYYY年MM月DD日 HH时mm分ss秒")),1)):l("",!0),s.value.status===1&&e.$store.state.lang==="en"?(a(),u("div",fe," Payment Time: "+n(i(_)(s.value.pay_time).format("MM/DD/YYYY HH:mm:ss")),1)):l("",!0),e.$store.state.lang==="cn"?(a(),u("div",$e," 发货状态："+n(s.value.is_deliver===0?"未发货":"已发货"),1)):l("",!0),e.$store.state.lang==="en"?(a(),u("div",De," Shipping Status: "+n(s.value.is_deliver===0?"Unshipped":"Shipped"),1)):l("",!0),s.value.shop_uuid&&e.$store.state.lang==="cn"?(a(),u("div",he,[d(k,{onClick:t[0]||(t[0]=r=>L())},{default:o(()=>t[8]||(t[8]=[m("联系客服")])),_:1})])):l("",!0),s.value.shop_uuid&&e.$store.state.lang==="en"?(a(),u("div",Ce,[d(k,{onClick:t[1]||(t[1]=r=>L())},{default:o(()=>t[9]||(t[9]=[m("Contact Customer Service")])),_:1})])):l("",!0),P.value.state==="3"&&!s.value.get_point&&e.$store.state.lang==="cn"?(a(),u("div",Ee,[d(k,{onClick:t[2]||(t[2]=r=>B())},{default:o(()=>t[10]||(t[10]=[m(" 获取积分 ")])),_:1})])):l("",!0),P.value.state==="3"&&!s.value.get_point&&e.$store.state.lang==="en"?(a(),u("div",Pe,[d(k,{onClick:t[3]||(t[3]=r=>B())},{default:o(()=>t[11]||(t[11]=[m(" Obtain Points ")])),_:1})])):l("",!0),s.value.is_deliver===1&&E.value.length&&e.$store.state.lang==="cn"?(a(),u("div",Se," 快递单号："+n(E.value[0].deliver_no),1)):l("",!0),s.value.is_deliver===1&&E.value.length&&e.$store.state.lang==="en"?(a(),u("div",Re," Tracking Number: "+n(E.value[0].deliver_no),1)):l("",!0),s.value.is_deliver===1&&e.$store.state.lang==="cn"?(a(),u("div",Ae,t[12]||(t[12]=[$("p",null,"快递轨迹：",-1)]))):l("",!0),s.value.is_deliver===1&&e.$store.state.lang==="en"?(a(),u("div",Ye,t[13]||(t[13]=[$("p",null,"Express Tracking Record: ",-1)]))):l("",!0),s.value.is_deliver===1&&e.$store.state.lang==="cn"?(a(),v(w,{key:28,modelValue:R.value,"onUpdate:modelValue":t[4]||(t[4]=r=>R.value=r),accordion:""},{default:o(()=>[d(U,{title:"点击查看快递轨迹信息",name:"1"},{default:o(()=>[s.value.is_deliver===1?(a(),v(H,{key:0,style:{"max-width":"600px"}},{default:o(()=>[(a(!0),u(T,null,I(P.value.data,(r,h)=>(a(),v(M,{key:h,timestamp:r.time},{default:o(()=>[m(n(r.context),1)]),_:2},1032,["timestamp"]))),128))]),_:1})):l("",!0)]),_:1})]),_:1},8,["modelValue"])):l("",!0),s.value.is_deliver===1&&e.$store.state.lang==="en"?(a(),v(w,{key:29,modelValue:R.value,"onUpdate:modelValue":t[5]||(t[5]=r=>R.value=r),accordion:""},{default:o(()=>[d(U,{title:"Click To View The Express Tracking Record Information",name:"1"},{default:o(()=>[s.value.is_deliver===1?(a(),v(H,{key:0,style:{"max-width":"600px"}},{default:o(()=>[(a(!0),u(T,null,I(P.value.data,(r,h)=>(a(),v(M,{key:h,timestamp:r.time},{default:o(()=>[m(n(r.context),1)]),_:2},1032,["timestamp"]))),128))]),_:1})):l("",!0)]),_:1})]),_:1},8,["modelValue"])):l("",!0),s.value.status===1&&!s.value.is_deliver&&!s.value.is_backing&&A.value.isCanPayBack&&e.$store.state.lang==="cn"?(a(),v(f,{key:30},{default:o(()=>[d(p,null,{default:o(()=>[d(k,{onClick:V},{default:o(()=>t[14]||(t[14]=[m(" 退款 ")])),_:1})]),_:1})]),_:1})):l("",!0),s.value.status===1&&!s.value.is_deliver&&!s.value.is_backing&&A.value.isCanPayBack&&e.$store.state.lang==="en"?(a(),v(f,{key:31},{default:o(()=>[d(p,null,{default:o(()=>[d(k,{onClick:V},{default:o(()=>t[15]||(t[15]=[m(" Refund ")])),_:1})]),_:1})]),_:1})):l("",!0),(a(!0),u(T,null,I(S.value,r=>(a(),u("div",be,[d(f,null,{default:o(()=>[d(p,null,{default:o(()=>[m(n(decodeURIComponent(r.title)),1)]),_:2},1024)]),_:2},1024),d(f,null,{default:o(()=>[d(p,null,{default:o(()=>[$("p",null,"¥ "+n(Number.parseFloat(r.price/100).toFixed(2)),1)]),_:2},1024)]),_:2},1024),e.$store.state.lang==="cn"?(a(),v(f,{key:0},{default:o(()=>[d(p,null,{default:o(()=>[$("p",null,n(r.amount)+" 件",1)]),_:2},1024)]),_:2},1024)):l("",!0),e.$store.state.lang==="en"?(a(),v(f,{key:1},{default:o(()=>[d(p,null,{default:o(()=>[$("p",null,n(r.amount)+" "+n(r.amount===1?"piece":"pieces"),1)]),_:2},1024)]),_:2},1024)):l("",!0)]))),256)),$("div",null,[d(f,null,{default:o(()=>[e.$store.state.lang==="cn"?(a(),v(p,{key:0},{default:o(()=>[m(" 商品总数："+n(S.value.length)+" 件 ",1)]),_:1})):l("",!0),e.$store.state.lang==="en"?(a(),v(p,{key:1},{default:o(()=>[m(" Total Number Of Products: "+n(S.value.length)+" "+n(S.value.length===1?"piece":"pieces"),1)]),_:1})):l("",!0),d(p,null,{default:o(()=>[$("p",null,"¥ "+n(Number.parseFloat((S.value||[]).reduce((r,h)=>r+h.price*h.amount,0)/100).toFixed(2)),1)]),_:1}),e.$store.state.lang==="cn"?(a(),v(p,{key:2,class:"pay-button"},{default:o(()=>[s.value.status===0&&s.value.status===0&&i(_)().diff(i(_)(s.value.create_time),"minutes")<=60?(a(),v(k,{key:0,type:"primary",onClick:t[6]||(t[6]=r=>O())},{default:o(()=>t[16]||(t[16]=[m("立即支付")])),_:1})):l("",!0)]),_:1})):l("",!0),e.$store.state.lang==="en"?(a(),v(p,{key:3,class:"pay-button"},{default:o(()=>[s.value.status===0&&s.value.status===0&&i(_)().diff(i(_)(s.value.create_time),"minutes")<=60?(a(),v(k,{key:0,type:"primary",onClick:t[7]||(t[7]=r=>O())},{default:o(()=>t[17]||(t[17]=[m("Pay Immediately")])),_:1})):l("",!0)]),_:1})):l("",!0)]),_:1})])])}}});export{Ve as default};
